<template name="header">
	{{#if preHeader}} {{>Template.dynamic template=preHeader }} {{/if}}
	<nav class="navbar navbar-default navbar-fixed-top">
		{{#unless screenSizeMobile}}
			<div class="title-image hidden-xs" style="height:{{settings.titleImageHeight}}px">
				<div style="background-image:url('{{imageUrl settings.imageTitleImage}}')"> </div>
				<img src="{{imageUrl settings.imageLogo}}" />
			</div>
		{{/unless}}

		<div class="container-fluid">
			<ul class="nav navbar-nav pull-right">
				{{#if currentUser}}
					<li class="{{#if equals routeName 'search'}}active{{/if}}">
						<a href="#" class="action-search">
							<span class="fa fa-search fa-lg"></span>
						</a>
					</li>
					<li class="hidden-xs {{#if equals routeName 'help'}}active{{/if}}">
						<a href="{{pathFor route='help'}}">
							<span class="fa fa-question-circle fa-lg"></span>
						</a>
					</li>
					<li class="hidden-xs dropdown">
						<a href="#" class="text-default dropdown-toggle"
							data-toggle="dropdown" aria-expanded="true">
							<span class="fa fa-user fa-lg"></span>
						</a>
						{{>userHeader}}
					</li>
				{{else}}
					<li class="dropdown">
						<a href="#" title="Anmelden" class="btn-login-link {{#unless meteorStatus.connected}}disabled{{/unless}}">
							<span class="fa fa-sign-in fa-lg fa-fw"></span> <span class="hidden-xs">Anmelden</span>
						</a>
					</li>
				{{/if}}					
				{{#if isAdmin}}
					<li class="hidden-xs {{#if equals routeName 'admin'}}active{{/if}}">
						<a href="{{pathFor route='admin'}}">
							<span class="fa fa-cog fa-lg"></span>
						</a>
					</li>
				{{/if}}
			</ul>
			<ul class="nav navbar-nav pull-left visible-xs">
				<li>
					<a href="#" class="action-toggle-sidebar">
						<span class="{{#if AdminNotifications.count}}text-info{{/if}} fa fa-bars fa-lg"></span>
						<span class="sr-only">Toggle navigation</span>
					</a>
				</li>
				{{#with sitePageHeader}}
					{{#if this.link}}
						<li>
							<a href="{{this.link}}">
							{{#if this.back}}
								{{this.back}}
							{{else}}
								<span class="fa fa-angle-left fa-lg"></span>
							{{/if}}
							</a>
						</li>
						{{#if this.name}}
							<li>
								<a href="#">
									{{this.name}}
								</a>
							</li>
						{{/if}}
					{{else}}
						<li>
							<a href="#">{{this.name}}</a>
						</li>
					{{/if}}
				{{/with}}
			</ul>
			<ul class="nav navbar-nav hidden-xs">
				{{>navLinks}}
			</ul>
		</div>
	</nav>
</template>
<template name="navLinks">
	{{#each settings.objectHeaderLinks.links}}
		{{#if showMenuEntry}}
			{{#if this.submenu}}
				<li class="dropdown {{../liClass}} {{#if isActive}}active{{/if}}">
					<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
                        {{this.text}} <span class="caret"></span>
                    </a>
					<ul class="dropdown-menu" role="menu">
						{{#each this.submenu}}
							{{#if this.target}}
								<li><a href="{{this.target}}">{{this.text}}</a></li>
							{{else}}
								<li>
									<hr/>
								</li>
							{{/if}}
						{{/each}}
					</ul>
				</li>
			{{else}}
				<li class="{{../liClass}} {{#if isActive}}active{{/if}}"><a class="" href="{{this.target}}">{{this.text}}</a>
				</li>
			{{/if}}
		{{/if}}
	{{/each}}
</template>
<template name="sidebar">
	<div class="navigation-area sidebar">
		<div class="title" style="background-image:url('{{imageUrl settings.imageMobileLogo}}')">
		</div>
		<div class="title" style="background-color:rgba(0,0,0,0.5);position:absolute;top:0px;">
			<a class="title-link" href="{{pathFor route='/'}}">{{settings.siteTitle}}</a>
			<a class="sub-title-link" href="{{pathFor route='/'}}">{{settings.siteSubTitle}}</a>
			{{#if currentUser}}
				<div class="user-header">
					<button class="btn btn-link" type="button">
                        <small>{{currentUser.profile.name}} {{currentUser.profile.surname}} ({{currentUser.username}})</small>
                    </button>
				</div>
			{{/if}}
		</div>

		{{#if currentUser}}
			<div class="list-group link-list">
				<a href="{{pathFor route='user' _id=currentUser._id }}" class="list-group-item {{#if isActive}}active{{/if}}">
						Einstellungen
				</a>
				<a href="#" class="list-group-item action-logout">
						Abmelden
				</a>
				<a href="#" class="list-group-item toggle-user-menu sublinks">
					<span class="fa fa-arrow-left"></span>
				</a>
			</div>
		{{/if}}
		<div class="list-group link-list visible-actions">
			{{#each settings.objectHeaderLinks.links}}
				{{#if showMenuEntry}}
					{{#if this.submenu}}
						<a href="#" class="list-group-item sublinks {{#if isActive}}active{{/if}}">
                        {{this.text}} <span class="caret"></span>
                    </a>
						<div class="submenu" role="menu" style="display:none">
							{{#each this.subLinks}}
								<a href="{{this.target}}" class="list-group-item">
                                {{this.text}}
                            </a>
							{{/each}}
						</div>
					{{else}}
						<a href="{{this.target}}" class="list-group-item {{#if isActive}}active{{/if}}">
                        {{this.text}}
                    </a>
					{{/if}}
				{{/if}}
			{{/each}}
			<a href="{{pathFor route='help'}}" class="list-group-item bg-{{this.style}}">
				<span class="fa fa-question-circle fa-fw"></span> Hilfe
			</a>
			{{#if currentUser}}
				<a href="{{pathFor route='user' _id=currentUser._id}}" class="list-group-item bg-{{this.style}}">
					<span class="fa fa-user fa-fw"></span> Einstellungen
				</a>
				<a href="#" class="list-group-item bg-{{this.style}} action-logout">
					<span class="fa fa-sign-out fa-fw"></span> Abmelden
				</a>
				<a href="#" class="list-group-item bg-{{this.style}} action-offline-fetch">
					<span class="fa fa-download fa-fw"></span> Aktualisieren
				</a>
			{{/if}}
			{{#if isAdmin}}
				<a href="{{pathFor route='admin'}}" class="list-group-item bg-{{this.style}}">
					<span class="fa fa-cog fa-fw"></span> Administration
					{{#with AdminNotifications}}
						<span class="badge">{{this.count}}</span>
					{{/with}}
				</a>
			{{/if}}
			<a class="list-group-item" href="{{pathFor route='wikipage' _id=settings.wikiImpressum}}">
				<span class="fa fa-info-circle"></span> Impressum
			</a>
		</div>
	</div>

</template>

<template name="userHeader">
	{{#if currentUser}}
		<ul class="dropdown-menu dropdown-menu-right" role="menu" aria-labelledby="dropdownUserMenu">
			<li class="dropdown-header">
				{{currentUser.username}} ({{currentUser.profile.name}} {{currentUser.profile.surname}})
			</li>
			<li role="presentation">
				<a class="goto-user-profile" role="menuitem" tabindex="-1" href="{{pathFor route='user' _id=currentUser._id }}">
					<span class="fa fa-user fa-fw"></span> Einstellungen
				</a>
			</li>
			<li role="presentation">
				<a class="action-logout" role="menuitem" tabindex="-1" href="#">
					<span class="fa fa-sign-out fa-fw"></span> Abmelden
				</a>
			</li>
			<li role="separator" class="divider"></li>
			<li role="presentation">
				<a class="action-offline-fetch" role="menuitem" tabindex="-1" href="#">
					<span class="fa fa-download fa-fw"></span> Aktualisieren
				</a>
			</li>
			{{#if isAdmin}}
				<li role="presentation">
					<a href="{{pathFor route='admin'}}">
					{{#with AdminNotifications}}
					<span class="badge pull-right">{{this.count}}</span>
					{{/with}}
					<span class="fa fa-cog"></span> Admin
				</a>
				</li>
			{{/if}}
		</ul>
	{{/if}}
</template>

<template name="content">
	{{> Template.dynamic template=template }}
</template>


<template name="footer">
	<div class="pull-right">
		<a href="{{pathFor route='wikipage' _id=settings.wikiImpressum}}">Impressum</a>
	</div>
	copyright by Lars Wolter
</template>